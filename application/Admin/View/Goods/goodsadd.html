<!DOCTYPE html>
<html><head>
	    <meta charset="utf-8">
    <title>nisa商城</title>

    <meta name="description" content="Dashboard">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!--Basic Styles-->
    <link href="__PUBLIC__/style/bootstrap.css" rel="stylesheet">
    <link href="__PUBLIC__/style/font-awesome.css" rel="stylesheet">
    <link href="__PUBLIC__/style/weather-icons.css" rel="stylesheet">

    <!--Beyond styles-->
    <link id="beyond-link" href="__PUBLIC__/style/beyond.css" rel="stylesheet" type="text/css">
    <link href="__PUBLIC__/style/demo.css" rel="stylesheet">
    <link href="__PUBLIC__/style/typicons.css" rel="stylesheet">
    <link href="__PUBLIC__/style/animate.css" rel="stylesheet">
    
    <!--引入百度编辑器-->
    <script src="__PUBLIC__/ueditor/ueditor.config.js"></script>
    <script src="__PUBLIC__/ueditor/ueditor.all.min.js"></script>
    <script src="__PUBLIC__/ueditor/lang/zh-cn/zh-cn.js"></script>
</head>
<body>
	<!-- 头部 -->
        <include file='Common/header' />
	<!-- /头部 -->
	
	<div class="main-container container-fluid">
		<div class="page-container">
			<!-- Page Sidebar -->
               <include file='Common/left' />
            <!-- /Page Sidebar -->
            <!-- Page Content -->
            <div class="page-content">
                <!-- Page Breadcrumb -->
                <div class="page-breadcrumbs">
                    <ul class="breadcrumb">
                      <li>
                        <a href="__MODULE__/Index/index">系统</a>
                      </li>
                      <li><a href="__CONTROLLER__/goodslist">商品列表</a></li>
                      <li class="active">新增商品</li>
                    </ul>
                </div>
                <!-- /Page Breadcrumb -->

                <!-- Page Body -->
                <div class="page-body">
                    
<div class="row">
    <div class="col-lg-12 col-sm-12 col-xs-12">
        <div class="widget">
            <div class="widget-header bordered-bottom bordered-blue">
                <span class="widget-caption">新增商品</span>
            </div>
            <div class="widget-body">
                <div id="horizontal-form">
                    <form class="form-horizontal" role="form" action="__SELF__" method="post" enctype="multipart/form-data">
                      <!------------------新增商品--------------->
                       <div class="tabbable"> 
                         <ul id="myTab11" class="nav nav-tabs tabs-flat">
                                <li class="active">
                                    <a href="#home11" data-toggle="tab">
                                        基本信息
                                    </a>
                                </li>
                                <li class="">
                                    <a href="#profile11" data-toggle="tab">
                                        商品描述
                                    </a>
                                </li>
                                <li class="">
                                    <a href="#profile12" data-toggle="tab">
                                        会员价格
                                    </a>
                                </li>
                                <li class="">
                                    <a href="#profile13" data-toggle="tab">
                                        商品属性
                                    </a>
                                </li>
                                <li class="">
                                    <a href="#profile14" data-toggle="tab">
                                        商品图片
                                    </a>
                                </li>
                            </ul>
                            <div class="tab-content tabs-flat">
                                <!--基本信息-->
                                <div class="tab-pane active" id="home11">

                                    <div class="form-group">
                                        <label for="goods_name" class="col-sm-2 control-label no-padding-right">商品名称</label>
                                        <div class="col-sm-6">
                                            <input class="form-control" id="goods_name" placeholder="输入商品名称"  name="goods_name" type="text">
                                        </div>
                                        <p class="help-block col-sm-4 red">* 必填</p>
                                    </div>
                                        <!--商品缩略图片-->
                                    <div class="form-group">
                                        <label for="original" class="col-sm-2 control-label no-padding-right">商品缩略图片</label>
                                        <div class="col-sm-6">
                                            <input  id="original" placeholder="输入商品名称"  name="original" type="file">
                                        </div>
                                    </div>
                                        <!--商品所属分类-->
                                    <div class="form-group">
                                        <label for="cate_id" class="col-sm-2 control-label no-padding-right">商品所属分类</label>
                                        <div class="col-sm-6">
                                            <select name="cate_id">
                                                <option value="">请选择</option>
                                                <volist name="categorys" id="value">
                                                <option value="{$value.cateid}">{$value['lavel']*3|str_repeat="&nbsp;&nbsp;",###}{$value.catename}</option>
                                                </volist>
                                            </select>
                                        </div>
                                    </div>
                                        <!--商品所属品牌-->
                                    <div class="form-group">
                                        <label for="brand_id" class="col-sm-2 control-label no-padding-right">商品所属品牌</label>
                                        <div class="col-sm-6">
                                            <select name="brand_id">
                                                <option>请选择</option>
                                                <volist name="brands" id="value" >
                                                <option value="{$value.id}">{$value.brand_name}</option>
                                                </volist>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="market_price" class="col-sm-2 control-label no-padding-right">市场价格</label>
                                        <div class="col-sm-6">
                                            <input class="form-control" id="market_price"  name="market_price" type="text">
                                        </div>
                                        <p class="help-block col-sm-4 red">* 必填</p>
                                    </div>

                                    <div class="form-group">
                                        <label for="shop_price" class="col-sm-2 control-label no-padding-right">本店价格</label>
                                        <div class="col-sm-6">
                                            <input class="form-control" id="shop_price"  name="shop_price" type="text">
                                        </div>
                                        <p class="help-block col-sm-4 red">* 必填</p>
                                    </div>
                                        <!--商品重量-->
                                     <div class="form-group">
                                        <label for="goods_weight" class="col-sm-2 control-label no-padding-right">商品重量</label>
                                        <div class="col-sm-6">
                                            <input class="form-control" id="goods_weight"  name="goods_weight" type="text" style="width:60%;float:left;margin-right:10px">
                                            <select name="weight_unit">
                                                <option value="kg">kg</option>
                                                <option value="g">g</option>
                                            </select>
                                        </div>
                                    </div>
                                        <!--是否上架-->
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label no-padding-right" for="onsale">是否上架</label>
                                       <div class="col-sm-6">
                                           <div class="checkbox">
                                                <label>
                                                    <input type="checkbox" name="onsale" checked="checked" class="colored-success">
                                                    <span class="text">上架</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <!--商品描述-->
                                <div class="tab-pane" id="profile11" >
                                    <textarea id="goods_des" name="goods_des" style="width:500px;height:500px;"></textarea>
                                </div>
                                <!--会员价格-->
                                <div class="tab-pane" id="profile12">
                                    <volist name="leveles" id="value">
                                    <div class="form-group">
                                        <label for="goods_name" class="col-sm-2 control-label no-padding-right">{$value.level_name}</label>
                                        <div class="col-sm-6">
                                            <input class="form-control" id=""   name="lev[{$value.id}]" type="text">
                                        </div>
                                    </div>
                                    </volist>
                                </div>
                                <!--商品属性-->
                                <div class="tab-pane" id="profile13">
                                    <div class="form-group">
                                        <label for="typename" class="col-sm-2 control-label no-padding-right">选择商品类型</label>
                                        <div class="col-sm-6">
                                            <select name="type">
                                                <option>选择商品类型</option>
                                                <volist name="goodstypes" id="value" >
                                                    <option value="{$value.id}">{$value.typename}</option>
                                                </volist>
                                            </select>
                                        </div>
                                    </div>
                                    <div id="attr"></div>
                                </div>
                                <!--商品图片-->
                                <div class="tab-pane" id="profile14">
                                    <div class="form-group">
                                        <label for="goods_name" class="col-sm-2 control-label no-padding-right">
                                            <a id="addimg" href="javascript:;">[+]</a>
                                        </label>
                                        <div class="col-sm-6">
                                            <input type="file"  name="goods_pics[]">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <input type="submit" value="添加商品" style="width:150px;" class="btn btn-darkorange btn-block">
                       </div>  
                      <!------------------新增商品--------------->
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

                </div>
                <!-- /Page Body -->
            </div>
            <!-- /Page Content -->
		</div>	
	</div>

	    <!--Basic Scripts-->
    <script src="__PUBLIC__/style/jquery_002.js"></script>
    <script src="__PUBLIC__/style/bootstrap.js"></script>
    <script src="__PUBLIC__/style/jquery.js"></script>
    <!--Beyond Scripts-->
    <script src="__PUBLIC__/style/beyond.js"></script>

    <script type="text/javascript">

        // <!--实例化编辑器-->
        // <!--建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例-->
        UE.getEditor('goods_des',{initialFrameWidth:900,initialFrameHeight:280,});
        var str='<div class="form-group"><label for="goods_name" class="col-sm-2 control-label no-padding-right"><a onclick="deltimg(this);" href="javascript:;">[-]</a></label><div class="col-sm-6"><input type="file"  name="goods_pics[]"></div></div>';
        $("#addimg").click(function (){
            $("#profile14").append(str);
        });
        function deltimg(o) {
            $(o).parent().parent().remove()
        }

        function attradd(o) {
            var div=$(o).parent().parent();
            if($(o).html()=='[+]'){
                var newdiv=div.clone();
                newdiv.find('a').html('[-]');
                div.after(newdiv)
            }else{
                div.remove();
            }
        }

        $("select[name=type]").change(function () {
            var typeid=$(this).val();
            $.ajax({
                type:"GET",
                url:"__CONTROLLER__/ajaxgetattr/typeid/"+typeid,
                dataType:"json",
                success:function (data) {
                    var html='';
                    $(data).each(function(k,v){
//                        html+="<div class='form-group'><label for='goods_name' class='col-sm-2 control-label no-padding-right'>"+v.attr_name+"</label><div class='col-sm-6'><input type='text'></div></div>";
//
                        if(v.attr_type=='1'){
                            var attrs=v.attr_value.split(",");
                            html+="<div class='form-group'><label for='goods_name' class='col-sm-2 control-label no-padding-right'><a href='javascript:;' onclick='attradd(this)'>[+]</a>"+v.attr_name+"</label><div class='col-sm-6'>";
                            html+="<select name='goods_attr["+v.id+"][]'><option>请选择</option>";
                            for(var i=0;i<attrs.length;i++){
                                html+="<option>"+attrs[i]+"</option>"
                            }
                            html+="</select><span>￥<input name='price[]' type='text' style='padding:6px 12px; width:70px;' value='0' /> 元</span>";
                            html+="</div></div>";
                        }else{
                            if(v.attr_value!=''){
                                var attrs=v.attr_value.split(",");
                                html+="<div class='form-group'><label for='goods_name' class='col-sm-2 control-label no-padding-right'>"+v.attr_name+"</label><div class='col-sm-6'>";
                                html+="<select name='goods_attr["+v.id+"][]'><option>请选择</option>";
                                for(var i=0;i<attrs.length;i++){
                                    html+="<option>"+attrs[i]+"</option>"
                                }
                                html+="</select><input name='price[]' type='hidden' style='padding:6px 12px; width:70px;' value='0' />";
                                html+="</div></div>";
                            }else{
                                html+="<div class='form-group'><label for='goods_name' class='col-sm-2 control-label no-padding-right'>"+v.attr_name+"</label><div class='col-sm-6'><input name=' goods_attr["+v.id+"][]' type='text' style='padding:6px 12px; width:70px;'></div></div><input name='price[]' type='hidden' style='padding:6px 12px; width:70px;' value='0' />";

                            }
                        }
                    });
                    $("#attr").html(html);
                }
            });
        })
    </script>

</body></html>